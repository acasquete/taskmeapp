<!DOCTYPE html>
<html>
<head>
    <title>TaskMe Setup</title>
    <script src="https://statics.teams.cdn.office.net/sdk/v1.11.0/js/MicrosoftTeams.min.js"></script>
</head>
<body>
    <script>
        microsoftTeams.initialize();

        microsoftTeams.initialize();

        microsoftTeams.getContext(function(context) {
            var userId = context.userObjectId; 
            var userName = context.userPrincipalName; 
            var userDisplayName = context.userDisplayName; 
            var channelId = context.channelId;
            var channelName = context.channelName;
            var teamId = context.teamId;

            var uuid = channelId.split('@')[0];

            const contentUrl = 'https://taskmeapp.com/?sid=' + uuid;

            microsoftTeams.settings.setSettings({
                    entityId: "tuEntidad", 
                    contentUrl: contentUrl,
                    suggestedDisplayName: "TaskMe",
                    websiteUrl: contentUrl
            });

            microsoftTeams.settings.setValidityState(true);

            microsoftTeams.settings.registerOnSaveHandler(function(saveEvent) {
                saveEvent.notifySuccess(); 
            });
        });
    </script>
</body>
</html>
